import{g as w,q as x,u as z,i as B,v,E,_ as O,r as i,k as j,o as A,f as n,b as a,e as m}from"./app-lSJJfXGm.js";const L=Symbol(),S=w({__name:"ToolFilter",setup(C,{expose:e}){e();const g=x({translatedOnly:"all",searchText:"",sort:{by:"published_at",descending:!0},channelTitle:""}),{videos:o,updateVideos:T}=z(L),h=B(()=>{const l=new Map;return o.value.orignal.forEach(s=>l.set(s.channel_title,(l.get(s.channel_title)||0)+1)),[...l.entries()].sort((s,_)=>_[1]-s[1]).map(s=>({value:s[0]}))}),c={filterData:g,videos:o,updateVideos:T,channelTitles:h,doFilter:l=>{const s=v.service({fullscreen:!0});new Promise(_=>{const F=(t,u)=>t==="ja"?!u.zh:t==="zh"?!!u.zh:!0,b=(t,u)=>{var p;const r=t.trim().toLowerCase();return r?u.video_id.toLowerCase()===r||((p=u.zh)==null?void 0:p.some(V=>V.video_bvid.toLowerCase()===r))||!1||u.title.toLowerCase().includes(r):!0},D=(t,u)=>t?u.channel_title===t:!0,d=t=>{const u=t.zh.reduce((r,p)=>new Date(p.added_at)>new Date(r.added_at)?p:r).added_at;return new Date(u).getTime()};let y=o.value.orignal.filter((t,u)=>(t.video_id==="r8fq4YN0o_Q"&&console.log("为啥沒筛选出来？？？",t,l,F(l.translatedOnly,t),b(l.searchText,t)),F(l.translatedOnly,t)&&b(l.searchText,t)&&D(l.channelTitle,t)&&!0)).sort((t,u)=>{let r=0;return l.sort.by==="published_at"?r=new Date(t.published_at).getTime()-new Date(u.published_at).getTime():l.sort.by==="added_at"&&(!t.zh&&u.zh?r=-1:t.zh&&!u.zh?r=1:t.zh&&u.zh&&(r=d(t)-d(u))),l.sort.descending?-r:r});o.value.filtered=y,s.close(),_(null)}).catch(_=>{E.error(_.message)})}};return Object.defineProperty(c,"__isScriptSetup",{enumerable:!1,value:!0}),c}});function k(C,e,g,o,T,h){const f=i("el-radio"),c=i("el-radio-group"),l=i("el-form-item"),s=i("el-tooltip"),_=i("el-autocomplete"),F=i("el-input"),b=i("el-button"),D=i("el-form");return A(),j(D,{model:o.filterData,"label-width":"auto",style:{"max-width":"700px",width:"100%"}},{default:n(()=>[a(l,{label:"语言"},{default:n(()=>[a(c,{modelValue:o.filterData.translatedOnly,"onUpdate:modelValue":e[0]||(e[0]=d=>o.filterData.translatedOnly=d)},{default:n(()=>[a(f,{value:"all"},{default:n(()=>e[5]||(e[5]=[m("全部")])),_:1}),a(f,{value:"zh"},{default:n(()=>e[6]||(e[6]=[m("熟肉")])),_:1}),a(f,{value:"ja"},{default:n(()=>e[7]||(e[7]=[m("生肉")])),_:1})]),_:1},8,["modelValue"])]),_:1}),a(l,{label:"排序"},{default:n(()=>[a(c,{modelValue:o.filterData.sort.by,"onUpdate:modelValue":e[1]||(e[1]=d=>o.filterData.sort.by=d)},{default:n(()=>[a(f,{value:"published_at"},{default:n(()=>e[8]||(e[8]=[m("上传时间")])),_:1}),a(s,{content:"本页面收录某视频的时间，仅对熟肉（b站视频）有效"},{default:n(()=>[a(f,{value:"added_at"},{default:n(()=>e[9]||(e[9]=[m("添加时间")])),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(l,{label:"频道名"},{default:n(()=>[a(_,{modelValue:o.filterData.channelTitle,"onUpdate:modelValue":e[2]||(e[2]=d=>o.filterData.channelTitle=d),"fetch-suggestions":o.channelTitles,clearable:""},null,8,["modelValue","fetch-suggestions"])]),_:1}),a(l,{label:"搜索内容"},{default:n(()=>[a(s,{content:"可搜索b站视频bv号，油管视频id, 视频标题"},{default:n(()=>[a(F,{modelValue:o.filterData.searchText,"onUpdate:modelValue":e[3]||(e[3]=d=>o.filterData.searchText=d),placeholder:"输入搜索内容"},null,8,["modelValue"])]),_:1})]),_:1}),a(l,null,{default:n(()=>[a(b,{type:"primary",onClick:e[4]||(e[4]=d=>o.doFilter(o.filterData))},{default:n(()=>e[10]||(e[10]=[m(" 筛选 ")])),_:1})]),_:1})]),_:1},8,["model"])}const M=O(S,[["render",k],["__file","ToolFilter.vue"]]),N=Object.freeze(Object.defineProperty({__proto__:null,default:M},Symbol.toStringTag,{value:"Module"}));export{M as F,N as T,L as v};
