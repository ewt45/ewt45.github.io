<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-rc.19">
    <script>
      (function() {
        const userMode = localStorage.getItem('vuepress-reco-color-scheme') || 'auto';
        const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (userMode === 'dark' || (userMode === 'auto' && systemDarkMode)) {
          document.documentElement.classList.toggle('dark', true);
        }
      })();
    </script>
    <title>在exagear未识别到数据包时提供手动选择数据包选项 | 博客</title><meta name="description" content="">
    <link rel="preload" href="/assets/style-BnPP2NeH.css" as="style"><link rel="stylesheet" href="/assets/style-BnPP2NeH.css">
    <link rel="modulepreload" href="/assets/app-lSJJfXGm.js"><link rel="modulepreload" href="/assets/index.html-gEKDxyu6.js">
    <link rel="prefetch" href="/assets/timeline.html-BAvVtoBI.js" as="script"><link rel="prefetch" href="/assets/posts.html-BDe9RmJC.js" as="script"><link rel="prefetch" href="/assets/friendship-link.html-5V_0ldeR.js" as="script"><link rel="prefetch" href="/assets/1.html-yy2yFytV.js" as="script"><link rel="prefetch" href="/assets/1.html-nTxjU1Bc.js" as="script"><link rel="prefetch" href="/assets/2.html-DZ-3w1VZ.js" as="script"><link rel="prefetch" href="/assets/3.html-DZ3bEvhb.js" as="script"><link rel="prefetch" href="/assets/1.html-ZRhaUqLX.js" as="script"><link rel="prefetch" href="/assets/1.html-Dw8_-m24.js" as="script"><link rel="prefetch" href="/assets/1.html-D2p--ZRn.js" as="script"><link rel="prefetch" href="/assets/1.html-BKcCMUG3.js" as="script"><link rel="prefetch" href="/assets/1.html-C6pQh-RC.js" as="script"><link rel="prefetch" href="/assets/1.html-CYKCRyI3.js" as="script"><link rel="prefetch" href="/assets/2.html-DJbJUUuj.js" as="script"><link rel="prefetch" href="/assets/1.html-B6B-juSh.js" as="script"><link rel="prefetch" href="/assets/1.html-v9pKxjgF.js" as="script"><link rel="prefetch" href="/assets/1.html-De7IlD7i.js" as="script"><link rel="prefetch" href="/assets/1.html-CHE8FBaR.js" as="script"><link rel="prefetch" href="/assets/1.html-RqMXOz5Q.js" as="script"><link rel="prefetch" href="/assets/1.html-Dof7uOmY.js" as="script"><link rel="prefetch" href="/assets/1.html-C5tNz7tA.js" as="script"><link rel="prefetch" href="/assets/1.html-CNMa2M-d.js" as="script"><link rel="prefetch" href="/assets/1.html-BoJFA7la.js" as="script"><link rel="prefetch" href="/assets/1.html-DK6IPxzw.js" as="script"><link rel="prefetch" href="/assets/1.html-BXhANdLw.js" as="script"><link rel="prefetch" href="/assets/1.html-BmUrsBLW.js" as="script"><link rel="prefetch" href="/assets/1.html-DNaqT86r.js" as="script"><link rel="prefetch" href="/assets/1.html-Dl0GJ-jH.js" as="script"><link rel="prefetch" href="/assets/1.html-yCcpQztl.js" as="script"><link rel="prefetch" href="/assets/1.html-DBv1IOaq.js" as="script"><link rel="prefetch" href="/assets/1.html-C0Zwxfqb.js" as="script"><link rel="prefetch" href="/assets/1.html-iVIhowxE.js" as="script"><link rel="prefetch" href="/assets/1.html-Bcnqkk_9.js" as="script"><link rel="prefetch" href="/assets/1.html-CYVqutMM.js" as="script"><link rel="prefetch" href="/assets/1.html-SDgp3aOs.js" as="script"><link rel="prefetch" href="/assets/1.html-B38hZpmE.js" as="script"><link rel="prefetch" href="/assets/1.html-C9q0qIEw.js" as="script"><link rel="prefetch" href="/assets/1.html-Bg9Js69h.js" as="script"><link rel="prefetch" href="/assets/2.html-eRtQpz5X.js" as="script"><link rel="prefetch" href="/assets/1.html-Dv_I2idE.js" as="script"><link rel="prefetch" href="/assets/1.html-Dn6C90gc.js" as="script"><link rel="prefetch" href="/assets/1.html-y1hVWCcl.js" as="script"><link rel="prefetch" href="/assets/1.html-BSQiaV1J.js" as="script"><link rel="prefetch" href="/assets/1.html-DXi2vSUl.js" as="script"><link rel="prefetch" href="/assets/1.html-Jgq6TbQK.js" as="script"><link rel="prefetch" href="/assets/1.html-CURNMHjC.js" as="script"><link rel="prefetch" href="/assets/1.html-CUfabN0R.js" as="script"><link rel="prefetch" href="/assets/1.html-ChhkJBFb.js" as="script"><link rel="prefetch" href="/assets/1.html-y8Il0XMP.js" as="script"><link rel="prefetch" href="/assets/1.html-CXBcIIjb.js" as="script"><link rel="prefetch" href="/assets/1.html-DEYIk8-q.js" as="script"><link rel="prefetch" href="/assets/1.html-CUB-76jf.js" as="script"><link rel="prefetch" href="/assets/1.html-BR-vtOCm.js" as="script"><link rel="prefetch" href="/assets/1.html-Di6IvUbD.js" as="script"><link rel="prefetch" href="/assets/1.html-iKeLMEA1.js" as="script"><link rel="prefetch" href="/assets/1.html-B23WFga2.js" as="script"><link rel="prefetch" href="/assets/1.html-DBAywDxx.js" as="script"><link rel="prefetch" href="/assets/1.html-C7gBBOTt.js" as="script"><link rel="prefetch" href="/assets/1.html-DtTuhNez.js" as="script"><link rel="prefetch" href="/assets/1.html-CjbxeMTY.js" as="script"><link rel="prefetch" href="/assets/1.html-VedXetm4.js" as="script"><link rel="prefetch" href="/assets/1.html-C7vkUq9U.js" as="script"><link rel="prefetch" href="/assets/1.html-CKoDS6cD.js" as="script"><link rel="prefetch" href="/assets/1.html-D2AjppoH.js" as="script"><link rel="prefetch" href="/assets/1.html-D6uas5Q5.js" as="script"><link rel="prefetch" href="/assets/1.html-DZaxw3Vt.js" as="script"><link rel="prefetch" href="/assets/1.html-Ciw9aOQK.js" as="script"><link rel="prefetch" href="/assets/2.html-Czvu1qhK.js" as="script"><link rel="prefetch" href="/assets/1.html-BL1u0BXg.js" as="script"><link rel="prefetch" href="/assets/1.html-DOrS_H42.js" as="script"><link rel="prefetch" href="/assets/1.html-D_-YFshT.js" as="script"><link rel="prefetch" href="/assets/1.html-C7oQNTeb.js" as="script"><link rel="prefetch" href="/assets/1.html-D6q7O-YE.js" as="script"><link rel="prefetch" href="/assets/1.html-BKtgxFao.js" as="script"><link rel="prefetch" href="/assets/1.html-ChHfA7Ub.js" as="script"><link rel="prefetch" href="/assets/1.html-BYmHK36B.js" as="script"><link rel="prefetch" href="/assets/1.html-kA591iPl.js" as="script"><link rel="prefetch" href="/assets/1.html-B6Z9JHUx.js" as="script"><link rel="prefetch" href="/assets/1.html-DeW5UuLV.js" as="script"><link rel="prefetch" href="/assets/1.html-Ly1Izu-z.js" as="script"><link rel="prefetch" href="/assets/1.html-D0dXHV11.js" as="script"><link rel="prefetch" href="/assets/1.html-CZ6hGlzj.js" as="script"><link rel="prefetch" href="/assets/1.html-CSl7qz7_.js" as="script"><link rel="prefetch" href="/assets/1.html-hoorisB2.js" as="script"><link rel="prefetch" href="/assets/1.html-DfMmJBkA.js" as="script"><link rel="prefetch" href="/assets/1.html-CvjQlPb-.js" as="script"><link rel="prefetch" href="/assets/1.html-mMwmaqNv.js" as="script"><link rel="prefetch" href="/assets/1.html-BbZEnfuL.js" as="script"><link rel="prefetch" href="/assets/1.html-DMy9vnUO.js" as="script"><link rel="prefetch" href="/assets/1.html-CaB-TTNA.js" as="script"><link rel="prefetch" href="/assets/1.html-DTTqmB1M.js" as="script"><link rel="prefetch" href="/assets/1.html-DG0Ri2-3.js" as="script"><link rel="prefetch" href="/assets/1.html-CbdOtFX6.js" as="script"><link rel="prefetch" href="/assets/1.html-BPggE-vd.js" as="script"><link rel="prefetch" href="/assets/1.html-HSH3YtDr.js" as="script"><link rel="prefetch" href="/assets/1.html-CblnYoQH.js" as="script"><link rel="prefetch" href="/assets/1.html-DW3jzJmF.js" as="script"><link rel="prefetch" href="/assets/1.html-EbscoznH.js" as="script"><link rel="prefetch" href="/assets/1.html-BVzHmXLV.js" as="script"><link rel="prefetch" href="/assets/1.html-ks4RjumV.js" as="script"><link rel="prefetch" href="/assets/1.html-BH1KfGMl.js" as="script"><link rel="prefetch" href="/assets/1.html-zPiztlwQ.js" as="script"><link rel="prefetch" href="/assets/1.html-DbQUkwnm.js" as="script"><link rel="prefetch" href="/assets/1.html-lC7lLhGV.js" as="script"><link rel="prefetch" href="/assets/1.html-CLYr7dtL.js" as="script"><link rel="prefetch" href="/assets/1.html-ojawvUMc.js" as="script"><link rel="prefetch" href="/assets/1.html-BZEAgw8b.js" as="script"><link rel="prefetch" href="/assets/1.html-DYCe7dPb.js" as="script"><link rel="prefetch" href="/assets/1.html-DTn0dGU2.js" as="script"><link rel="prefetch" href="/assets/1.html--B2a8o7V.js" as="script"><link rel="prefetch" href="/assets/1.html-7Ua1aPJo.js" as="script"><link rel="prefetch" href="/assets/1.html-Gj4i9rQj.js" as="script"><link rel="prefetch" href="/assets/1.html-BoZMEBVy.js" as="script"><link rel="prefetch" href="/assets/1.html-XU3T-WYT.js" as="script"><link rel="prefetch" href="/assets/1.html-D1V-fulj.js" as="script"><link rel="prefetch" href="/assets/1.html-pymXCC7r.js" as="script"><link rel="prefetch" href="/assets/2.html-Ubr6swgl.js" as="script"><link rel="prefetch" href="/assets/3.html-CjLKwczA.js" as="script"><link rel="prefetch" href="/assets/4.html-CZDmeODS.js" as="script"><link rel="prefetch" href="/assets/5.html-CvM0EXix.js" as="script"><link rel="prefetch" href="/assets/index.html-BBKCb86C.js" as="script"><link rel="prefetch" href="/assets/index.html-Cy-Y6qO0.js" as="script"><link rel="prefetch" href="/assets/index.html--IG5pKEw.js" as="script"><link rel="prefetch" href="/assets/index.html-D_zAtQ3A.js" as="script"><link rel="prefetch" href="/assets/index.html-QY7s6tas.js" as="script"><link rel="prefetch" href="/assets/index.html-DDwaHnCa.js" as="script"><link rel="prefetch" href="/assets/index.html-DgszJxPY.js" as="script"><link rel="prefetch" href="/assets/deprecated.html-CRMXFzvC.js" as="script"><link rel="prefetch" href="/assets/index.html-Rc_VX8bK.js" as="script"><link rel="prefetch" href="/assets/index_EN.html-ByFpT8Si.js" as="script"><link rel="prefetch" href="/assets/index.html-BuF_ye6e.js" as="script"><link rel="prefetch" href="/assets/index.html-DWAaArns.js" as="script"><link rel="prefetch" href="/assets/index.html-CqZrKvZ4.js" as="script"><link rel="prefetch" href="/assets/index.html-BdQrDGCb.js" as="script"><link rel="prefetch" href="/assets/index.html-DfEreS3A.js" as="script"><link rel="prefetch" href="/assets/index.html-xfauZgFa.js" as="script"><link rel="prefetch" href="/assets/index.html-CPq8pEd4.js" as="script"><link rel="prefetch" href="/assets/index.html-QR87e8Ls.js" as="script"><link rel="prefetch" href="/assets/detailed.html-CYf3qOPR.js" as="script"><link rel="prefetch" href="/assets/index.html-CQq5mgbv.js" as="script"><link rel="prefetch" href="/assets/index.html-BMQ4-iAy.js" as="script"><link rel="prefetch" href="/assets/index.html-B679GBm9.js" as="script"><link rel="prefetch" href="/assets/index.html-CCrvZbLJ.js" as="script"><link rel="prefetch" href="/assets/driveD.html-CcD-EJvX.js" as="script"><link rel="prefetch" href="/assets/index.html-BQuueml5.js" as="script"><link rel="prefetch" href="/assets/index.html-Bhz11Ob5.js" as="script"><link rel="prefetch" href="/assets/index.html-BkeY5tbW.js" as="script"><link rel="prefetch" href="/assets/index.html-Bvnzpb-9.js" as="script"><link rel="prefetch" href="/assets/index.html-DCAyTCDU.js" as="script"><link rel="prefetch" href="/assets/index.html-DD-LFEVB.js" as="script"><link rel="prefetch" href="/assets/index.html-DkAhnggS.js" as="script"><link rel="prefetch" href="/assets/index.html-DFxQCUU9.js" as="script"><link rel="prefetch" href="/assets/index.html-9VL9SfQK.js" as="script"><link rel="prefetch" href="/assets/index.html-BlTTay7L.js" as="script"><link rel="prefetch" href="/assets/index.html-t5GXM772.js" as="script"><link rel="prefetch" href="/assets/index.html-CSlhuypt.js" as="script"><link rel="prefetch" href="/assets/index.html-C5jNpAm8.js" as="script"><link rel="prefetch" href="/assets/index.html-DjJMF_aD.js" as="script"><link rel="prefetch" href="/assets/index.html-Dgv5WEvh.js" as="script"><link rel="prefetch" href="/assets/index.html-DBOL5oAg.js" as="script"><link rel="prefetch" href="/assets/index.html-CyMED2UU.js" as="script"><link rel="prefetch" href="/assets/index.html-Brt8k1u9.js" as="script"><link rel="prefetch" href="/assets/index.html-DTKB9h7D.js" as="script"><link rel="prefetch" href="/assets/index_en.html-BXYBFagB.js" as="script"><link rel="prefetch" href="/assets/index.html-C3TPFGWv.js" as="script"><link rel="prefetch" href="/assets/index.html-BEi31oBx.js" as="script"><link rel="prefetch" href="/assets/index.html-DQMJgohn.js" as="script"><link rel="prefetch" href="/assets/index.html-oa6BlAsi.js" as="script"><link rel="prefetch" href="/assets/index.html-C22QzVzY.js" as="script"><link rel="prefetch" href="/assets/index.html-DoJ7ZtnH.js" as="script"><link rel="prefetch" href="/assets/index.html-BGBq_6tl.js" as="script"><link rel="prefetch" href="/assets/index.html-De0w7Z4M.js" as="script"><link rel="prefetch" href="/assets/index.html-DPCBOMd7.js" as="script"><link rel="prefetch" href="/assets/404.html-BfWx50pL.js" as="script"><link rel="prefetch" href="/assets/Valine.min-Bnm5pcBZ.js" as="script"><link rel="prefetch" href="/assets/giscus-aTimukGI-DWEKOTfS.js" as="script"><link rel="prefetch" href="/assets/PokopeaMain-MDrkiEMa.js" as="script"><link rel="prefetch" href="/assets/example-CYQHARbw.js" as="script"><link rel="prefetch" href="/assets/main-BTkXXdD8.js" as="script"><link rel="prefetch" href="/assets/ActionBili-Czh0m-6-.js" as="script"><link rel="prefetch" href="/assets/ActionDialog-CVwUbXiR.js" as="script"><link rel="prefetch" href="/assets/ActionInfo-B23WMb5r.js" as="script"><link rel="prefetch" href="/assets/ActionSub-Pfdqagrq.js" as="script"><link rel="prefetch" href="/assets/ActionYt-CrnOPkTb.js" as="script"><link rel="prefetch" href="/assets/IconBili-CMtoYxHz.js" as="script"><link rel="prefetch" href="/assets/IconInfo-D1wXkJcd.js" as="script"><link rel="prefetch" href="/assets/IconSub-D5TM9A67.js" as="script"><link rel="prefetch" href="/assets/IconYt-D_vP9lhp.js" as="script"><link rel="prefetch" href="/assets/ToolDarkMode-9w8ghlWD.js" as="script"><link rel="prefetch" href="/assets/ToolFilter-B32drc-T.js" as="script"><link rel="prefetch" href="/assets/ToolInfoLink-DOCFQvn0.js" as="script"><link rel="prefetch" href="/assets/ToolMenus-yA0GO2Nj.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-DfZWbE-_.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container series--no show-catalog"><header class="navbar-container not-open"><div class="navbar-inner"><div class="site-brand nav-item"><!----><a href="/" class="site-name">博客</a></div><div class="nav-item navbar-links-wrapper" style=""><div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div><nav class="navbar-links"><!--[--><div class="navbar-links__item"><a href="/" class="link" aria-label="首页"><!--[--><!--]--><span class="xicon-container left"><!--[--><IconHome class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"></IconHome><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->首页<!--]--></span></span><!--[--><!--]--></a></div><!--]--><!----><span class="xicon-container btn-toggle-dark-mode btn--dark-mode navbar-links__item"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:;"><path d="M15 2h2v3h-2z" fill="currentColor"></path><path d="M27 15h3v2h-3z" fill="currentColor"></path><path d="M15 27h2v3h-2z" fill="currentColor"></path><path d="M2 15h3v2H2z" fill="currentColor"></path><path d="M5.45 6.884l1.414-1.415l2.121 2.122l-1.414 1.414z" fill="currentColor"></path><path d="M23 7.58l2.121-2.12l1.414 1.414l-2.121 2.121z" fill="currentColor"></path><path d="M23.002 24.416l1.415-1.414l2.12 2.122l-1.413 1.414z" fill="currentColor"></path><path d="M5.47 25.13L7.59 23L9 24.42l-2.12 2.12l-1.41-1.41z" fill="currentColor"></path><path d="M16 8a8 8 0 1 0 8 8a8 8 0 0 0-8-8zm0 14a6 6 0 0 1 0-12z" fill="currentColor"></path></svg></span><ul class="social-links navbar-links__item"><!--[--><!--]--></ul></nav><span class="xicon-container btn-toggle-menus"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:;"><circle cx="16" cy="8" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="24" r="2" fill="currentColor"></circle></svg></span></div></div></header><!----><!----><!----><div class="theme-main" style=""><!----><!--[--><main class="page-container"><div class="page-content"><h1 class="page-title">在exagear未识别到数据包时提供手动选择数据包选项</h1><div class="page-info"><!----><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2023-1-18 15:32:00<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M11.17 6l3.42 3.41l.58.59H28v16H4V6h7.17m0-2H4a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2H16l-3.41-3.41A2 2 0 0 0 11.17 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><!--[--><a href="/categories/exagear/1.html" class="">exagear</a><a href="/categories/jishu/1.html" class="">技术</a><!--]--><!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M10 14a4 4 0 1 1 4-4a4.005 4.005 0 0 1-4 4zm0-6a2 2 0 1 0 1.998 2.004A2.002 2.002 0 0 0 10 8z" fill="currentColor"></path><path d="M16.644 29.415L2.586 15.354A2 2 0 0 1 2 13.941V4a2 2 0 0 1 2-2h9.941a2 2 0 0 1 1.414.586l14.06 14.058a2 2 0 0 1 0 2.828l-9.943 9.943a2 2 0 0 1-2.829 0zM4 4v9.942L18.058 28L28 18.058L13.942 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><!--[--><a href="/tags/content-resolver/1.html" class="">content resolver</a><!--]--><!--]--></span></span><!----></div><div class="theme-reco-md-content"><div><nav class="table-of-contents"><ul><li><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#前言" class="router-link-active router-link-exact-active">前言</a></li><li><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#演示视频" class="router-link-active router-link-exact-active">演示视频：</a></li><li><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#将此功能添加到apk" class="router-link-active router-link-exact-active">将此功能添加到apk</a><ul><li><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#自助修改" class="router-link-active router-link-exact-active">自助修改</a></li><li><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#手动修改" class="router-link-active router-link-exact-active">手动修改</a></li><li><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#已改好apk" class="router-link-active router-link-exact-active">已改好apk</a></li></ul></li><li><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#探索过程" class="router-link-active router-link-exact-active">探索过程</a><ul><li><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#分析ed的dex" class="router-link-active router-link-exact-active">分析ed的dex</a></li><li><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#打开系统自带的文件选择器" class="router-link-active router-link-exact-active">打开系统自带的文件选择器</a></li><li><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#获取文件并让ex读取到这个文件" class="router-link-active router-link-exact-active">获取文件并让ex读取到这个文件</a></li><li><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#onactivityresult的处理" class="router-link-active router-link-exact-active">onActivityResult的处理</a></li><li><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#如何将fragment挂载到视图上" class="router-link-active router-link-exact-active">如何将fragment挂载到视图上</a></li></ul></li><li><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#总结" class="router-link-active router-link-exact-active">总结</a></li></ul></nav><h2 id="前言" tabindex="-1"><a class="header-anchor" href="#前言"><span>前言</span></a></h2><p>由于现在exagear安装只能从第三方获取，所以需要用户手动放置数据包。当apk没有在默认位置（/sdcard/Android/obb/包名，现在大部分apk还有一个第二位置 /sdcard）下找到对应文件名（main.数字.包名.obb）的obb文件，就会报错 <code>failed to find exagear image</code>。</p><p>某些情况下，如不了解obb的用户可能无法检查出问题所在（比如数据包名字前多了几个文字），或者在高版本安卓上无法放入obb文件夹，此时可以通过手动选择的方式来选取obb数据包。</p><p><img src="/assets/2-cyNrTICD.gif" alt="gif1"></p><div class="custom-container warning"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8v4"></path><path d="M12 16h.01"></path></g></svg><p class="custom-container-title">WARNING</p><p>由于安卓限制，安卓11及以上无法使用文件选择器查看Android/data和Android/obb目录下的文件。</p></div><h2 id="演示视频" tabindex="-1"><a class="header-anchor" href="#演示视频"><span>演示视频：</span></a></h2><p><a href="https://space.bilibili.com/29460173/channel/collectiondetail?sid=598657" target="_blank" rel="noopener noreferrer">我的合集和视频列表 &gt; exagear<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="将此功能添加到apk" tabindex="-1"><a class="header-anchor" href="#将此功能添加到apk"><span>将此功能添加到apk</span></a></h2><p>推荐使用ED自助补丁一键修改。<br> 如果你掌握apk的基础修改知识，也可以照下方教程手动修改，但本页面提供的文件可能比ED自助补丁要旧。<br> 如果ED自助补丁也用不明白，那么应该去寻找已经修改好的apk直接使用。</p><h3 id="自助修改" tabindex="-1"><a class="header-anchor" href="#自助修改"><span>自助修改</span></a></h3><p>使用ED自助补丁，用户完全不需要手动编辑smali，只需点一个按钮，等待修改完成后安装新的apk即可。</p><p><a href="https://github.com/ewt45/EDPatch/releases" target="_blank" rel="noopener noreferrer">下载地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://www.bilibili.com/video/BV1mY411X7Nn/" target="_blank" rel="noopener noreferrer">视频介绍<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="手动修改" tabindex="-1"><a class="header-anchor" href="#手动修改"><span>手动修改</span></a></h3><p>用MT管理器编辑dex</p><ol><li><p><code>com.eltechs.axs.configuration.startup.actions.UnpackExagearImageObb</code>类，<code>execute</code>方法中,将installImageFromObbIfNeeded改为installImageFromObbIfNeededNew，以便显示fragment</p><div class="language-smali line-numbers-mode" data-highlighter="prismjs" data-ext="smali" data-title="smali"><pre><code><span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment">#invoke-virtual {v8}, Lcom/eltechs/axs/helpers/ZipInstallerObb;-&gt;installImageFromObbIfNeeded()V</span></span>
<span class="line">invoke-virtual <span class="token punctuation">{</span><span class="token register variable">v8</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token builtin">L</span><span class="token namespace">com<span class="token punctuation">/</span>eltechs<span class="token punctuation">/</span>axs<span class="token punctuation">/</span>helpers<span class="token punctuation">/</span></span><span class="token class-name">ZipInstallerObb</span></span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">installImageFromObbIfNeededNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">V</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>在com.eltechs.axs.helpers.ZipInstallerObb类中，结尾处添加installImageFromObbIfNeededNew方法。</p><details class="custom-container details"><summary class="custom-container-title">点击展开代码</summary><div class="language-smali line-numbers-mode" data-highlighter="prismjs" data-ext="smali" data-title="smali"><pre><code><span class="line"></span>
<span class="line"><span class="token keyword">.method</span> <span class="token keyword">public</span> <span class="token function">installImageFromObbIfNeededNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">V</span></span>
<span class="line">    <span class="token keyword">.registers</span> <span class="token number">2</span></span>
<span class="line">    <span class="token keyword">.annotation</span> <span class="token keyword">system</span> <span class="token class-name"><span class="token builtin">L</span><span class="token namespace">dalvik<span class="token punctuation">/</span>annotation<span class="token punctuation">/</span></span><span class="token class-name">Throws</span></span><span class="token punctuation">;</span></span>
<span class="line">        value <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token class-name"><span class="token builtin">L</span><span class="token namespace">java<span class="token punctuation">/</span>io<span class="token punctuation">/</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">.end</span> <span class="token keyword">annotation</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">.line</span> <span class="token number">36</span></span>
<span class="line">    invoke-direct <span class="token punctuation">{</span><span class="token register variable">p0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token builtin">L</span><span class="token namespace">com<span class="token punctuation">/</span>eltechs<span class="token punctuation">/</span>axs<span class="token punctuation">/</span>helpers<span class="token punctuation">/</span></span><span class="token class-name">ZipInstallerObb</span></span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">checkObbUnpackNeed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">Z</span></span>
<span class="line"></span>
<span class="line">    move-result <span class="token register variable">v0</span></span>
<span class="line"></span>
<span class="line">    if-eqz <span class="token register variable">v0</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token label property">cond_10</span></span>
<span class="line"></span>
<span class="line">    invoke-direct <span class="token punctuation">{</span><span class="token register variable">p0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token builtin">L</span><span class="token namespace">com<span class="token punctuation">/</span>eltechs<span class="token punctuation">/</span>axs<span class="token punctuation">/</span>helpers<span class="token punctuation">/</span></span><span class="token class-name">ZipInstallerObb</span></span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">findObbFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name"><span class="token builtin">L</span><span class="token namespace">java<span class="token punctuation">/</span>io<span class="token punctuation">/</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    move-result-object <span class="token register variable">v0</span></span>
<span class="line"></span>
<span class="line">    if-nez <span class="token register variable">v0</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token label property">cond_10</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">.line</span> <span class="token number">37</span></span>
<span class="line">    invoke-static <span class="token punctuation">{</span><span class="token register variable">p0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token builtin">L</span><span class="token namespace">com<span class="token punctuation">/</span>example<span class="token punctuation">/</span>datainsert<span class="token punctuation">/</span>exagear<span class="token punctuation">/</span>obb<span class="token punctuation">/</span></span><span class="token class-name">ProcessInstallObb</span></span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token class-name"><span class="token builtin">L</span><span class="token namespace">com<span class="token punctuation">/</span>eltechs<span class="token punctuation">/</span>axs<span class="token punctuation">/</span>helpers<span class="token punctuation">/</span></span><span class="token class-name">ZipInstallerObb</span></span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token builtin">V</span></span>
<span class="line"></span>
<span class="line">    goto <span class="token punctuation">:</span><span class="token label property">goto_13</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">.line</span> <span class="token number">39</span></span>
<span class="line">    <span class="token punctuation">:</span><span class="token label property">cond_10</span></span>
<span class="line">    invoke-virtual <span class="token punctuation">{</span><span class="token register variable">p0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token builtin">L</span><span class="token namespace">com<span class="token punctuation">/</span>eltechs<span class="token punctuation">/</span>axs<span class="token punctuation">/</span>helpers<span class="token punctuation">/</span></span><span class="token class-name">ZipInstallerObb</span></span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">installImageFromObbIfNeeded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">V</span></span>
<span class="line"></span>
<span class="line">    <span class="token punctuation">:</span><span class="token label property">goto_13</span></span>
<span class="line">    return-void</span>
<span class="line"><span class="token keyword">.end</span> <span class="token keyword">method</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details></li><li><p>还是ZipInstallerObb类，在findObbFile()方法中，结尾<code>return-object v0</code>之前添加代码</p><div class="language-smali line-numbers-mode" data-highlighter="prismjs" data-ext="smali" data-title="smali"><pre><code><span class="line"><span class="token comment">#在return-object v0之前添加这行</span></span>
<span class="line">sget-object <span class="token register variable">v0</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token builtin">L</span><span class="token namespace">com<span class="token punctuation">/</span>example<span class="token punctuation">/</span>datainsert<span class="token punctuation">/</span>exagear<span class="token punctuation">/</span>obb<span class="token punctuation">/</span></span><span class="token class-name">SelectObbFragment</span></span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token field variable">obbFile</span><span class="token punctuation">:</span><span class="token class-name"><span class="token builtin">L</span><span class="token namespace">java<span class="token punctuation">/</span>io<span class="token punctuation">/</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>在<code>UnpackExagearImageObb$1.smali</code>类中（注意名字带<code>$1</code>），<code>unpackingCompleted</code>方法中，开头添加一句，用于在解压完成后删除临时obb。</p><div class="language-smali line-numbers-mode" data-highlighter="prismjs" data-ext="smali" data-title="smali"><pre><code><span class="line">invoke-static <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token builtin">L</span><span class="token namespace">com<span class="token punctuation">/</span>example<span class="token punctuation">/</span>datainsert<span class="token punctuation">/</span>exagear<span class="token punctuation">/</span>obb<span class="token punctuation">/</span></span><span class="token class-name">SelectObbFragment</span></span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">delCopiedObb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">V</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>在<code>com.eltechs.axs.activities.StartupActivity</code>类中，<code>onActivityResult</code>方法中，开头处添加。用于获取手动选择文件。</p><div class="language-smali line-numbers-mode" data-highlighter="prismjs" data-ext="smali" data-title="smali"><pre><code><span class="line">    <span class="token comment"># 添加到方法开头。如果相等，用cond正常往下走，否则调用fragment处理文件并goto直接返回</span></span>
<span class="line">    const/16 <span class="token register variable">v1</span><span class="token punctuation">,</span> <span class="token number">0x2711</span></span>
<span class="line"></span>
<span class="line">    if-eq <span class="token register variable">p1</span><span class="token punctuation">,</span> <span class="token register variable">v1</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token label property">cond_3a</span></span>
<span class="line"></span>
<span class="line">    invoke-static <span class="token punctuation">{</span><span class="token register variable">p0</span><span class="token punctuation">,</span> <span class="token register variable">p1</span><span class="token punctuation">,</span> <span class="token register variable">p2</span><span class="token punctuation">,</span> <span class="token register variable">p3</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token builtin">L</span><span class="token namespace">com<span class="token punctuation">/</span>example<span class="token punctuation">/</span>datainsert<span class="token punctuation">/</span>exagear<span class="token punctuation">/</span>obb<span class="token punctuation">/</span></span><span class="token class-name">SelectObbFragment</span></span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">receiveResultManually</span><span class="token punctuation">(</span><span class="token class-name"><span class="token builtin">L</span><span class="token namespace">android<span class="token punctuation">/</span>support<span class="token punctuation">/</span>v7<span class="token punctuation">/</span>app<span class="token punctuation">/</span></span><span class="token class-name">AppCompatActivity</span></span><span class="token punctuation">;</span><span class="token builtin">II</span><span class="token class-name"><span class="token builtin">L</span><span class="token namespace">android<span class="token punctuation">/</span>content<span class="token punctuation">/</span></span><span class="token class-name">Intent</span></span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token builtin">V</span></span>
<span class="line"></span>
<span class="line">    goto <span class="token punctuation">:</span><span class="token label property">goto_49</span> <span class="token comment">#这个goto_49是return-void前的标记，可能不是49是其他数字需要注意一下</span></span>
<span class="line"></span>
<span class="line">    <span class="token punctuation">:</span><span class="token label property">cond_3a</span></span>
<span class="line">    <span class="token comment">#...</span></span>
<span class="line">    <span class="token comment">#...</span></span>
<span class="line">    <span class="token punctuation">:</span><span class="token label property">goto_49</span></span>
<span class="line">    return-void</span>
<span class="line"><span class="token keyword">.end</span> <span class="token keyword">method</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>添加<a href="https://wwqv.lanzout.com/iBQ5b0lo5nfe" target="_blank" rel="noopener noreferrer">这个压缩包<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>中的全部类到dex中。</p></li><li><p>编译dex，重装apk。</p></li></ol><h3 id="已改好apk" tabindex="-1"><a class="header-anchor" href="#已改好apk"><span>已改好apk</span></a></h3><p>无</p><h2 id="探索过程" tabindex="-1"><a class="header-anchor" href="#探索过程"><span>探索过程</span></a></h2><p>本节为自用，主要记录实现java代码的过程。</p><h3 id="分析ed的dex" tabindex="-1"><a class="header-anchor" href="#分析ed的dex"><span>分析ed的dex</span></a></h3><p>UnpackExagearImageObb类里，新建ZipInstallerObb实例，新建一个callback并传入，并调用方法installImageFromObbIfNeeded进行检查并解压数据包。</p><p>installImageFromObbIfNeeded先调用checkObbUnpackNeed()判断是否需要解压，如果需要，数据包文件通过findObbFile()获取，然后新建一个AsyncTask，完成的时候调用callback的unpackingCompleted，进而调用UnpackExagearImageObb类里的sendDone方法结束这个action。同理可以显示进度/报错。</p><p>findObbFile()方法：先从Android/obb/包名中尝试获取格式化名称的数据包，如果不存在尝试获取根目录下的同名文件。如果这两者有一个获取到了就返回，没获取到就将**versioncode减1再继续找。。**versioncode就是数据包名字中的数字那部分，没想到居然还会向下找。如果啥都找不到，那就返回null。</p><p>checkObbUnpackNeed方法：这个方法很绝，依赖于findObbFile，所以如果想获得正确返回值，必须在调用check之前先调用一遍findObbFile。。。</p><h3 id="打开系统自带的文件选择器" tabindex="-1"><a class="header-anchor" href="#打开系统自带的文件选择器"><span>打开系统自带的文件选择器</span></a></h3><p>一开始有这个想法是在写切换d盘路径的时候，看到ib键盘007,设置保存安装文件的路径调用了这个。然后搜了一下发现貌似要在manifest里加fileprovider看起来还挺麻烦就放弃了。直到最近写打包apk发现如果只是获取个文件并不用fileprovider（甚至不需要文件存储权限），只需要发送个intent就行了。遂实现了一下。</p><p>参考文档：https://developer.android.google.cn/training/data-storage/shared/documents-files?hl=zh-cn#open-file</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span><span class="token constant">ACTION_OPEN_DOCUMENT</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">intent<span class="token punctuation">.</span><span class="token function">addCategory</span><span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span><span class="token constant">CATEGORY_OPENABLE</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">intent<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;*/*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">startActivityForResult</span><span class="token punctuation">(</span>intent<span class="token punctuation">,</span> <span class="token constant">PICK_OBB_FILE</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>显示一个按钮，点击时发这个intent就行了。然后选择的文件在onActivityResult函数中接收到。所以至少要写个fragment，重写onActivityResult（然而遇到一堆问题），通过第三个参数的intent.getData()获取文件的uri。</p><h3 id="获取文件并让ex读取到这个文件" tabindex="-1"><a class="header-anchor" href="#获取文件并让ex读取到这个文件"><span>获取文件并让ex读取到这个文件</span></a></h3><p>uri的api和file的api稍有不同，只能获取到输入流。而ex的解压数据包传参数用的都是file，所以需要先通过文件流复制一份obb数据包到自己的数据目录下（使用apache的commons-io的IOUtils即可，才发现我之前一直用的compress里的IOUtils，不知道有什么区别），然后再把这个拷贝过来的临时obb作为file传给ex以供解压。解压后还应该删掉防止占过多存储空间。</p><p>整理一下，流程大概是：ZipInstallerObb中先检查是否需要解压，如果要解压且没找到数据包（findObbFile()返回null），就新建fragment显示手动选择的按钮。<br> 如何实现解压时获取到复制过来的手动选择的数据包：fragment设置一个静态变量obbFile，在findObbFile()中结尾处，直接返回0（null）改为返回obbFile，当然obbFile初始也是null，只有fragment接收到文件了之后才是对应文件。<br> 如何实现解压后删除复制过来的手动选择的数据包：解压完成后ZipInstallerObb会调用callbacks.unpackingCompleted()，而callback是在 UnpackExagearImageObb中实现的，所以只需要在这个类里找到unpackingCompleted函数，在其中调用自己的函数删除文件即可。</p><h3 id="onactivityresult的处理" tabindex="-1"><a class="header-anchor" href="#onactivityresult的处理"><span>onActivityResult的处理</span></a></h3><p>在自己的apk中测试时，并没有什么问题，不过添加到ex中之后遇到了两个问题：</p><ul><li>获取文件后，首先在activity的onActivityResult里接收到了，而且其中 assert了requestCode，导致不等于10001的都报错。而且fragment压根没接收到。</li><li>在fragment中调用的startActivityFoResult，在fragment中接收结果时requestCode是对的，但是在activity里接收到的是错的。</li></ul><p>又拿自己的apk试了一下，发现原因：</p><ul><li>结果首先发给活动，活动如果调用super，结果就会发给fragment，ex由于并没有调用super，所以我的fragment接收不到。解决方法：调用自己的静态方法，传入activity的this和原有的三个参数，通过activity获取碎片管理器进而通过tag获取碎片实例，然后再处理结果。至于那个assert，我加了判断如果不等于10001一律调用自己的这个静态方法然后直接返回。</li><li>requestCode不对的问题，原因是<a href="https://stackoverflow.com/questions/10564474/wrong-requestcode-in-onactivityresult" target="_blank" rel="noopener noreferrer">被activity改了<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，因为是通过fragment的start发出去的，要么在fragment里接收并处理，要么activity里接收的requestCode&amp;0x0000ffff</li></ul><p>在修改smali时，因为需要处理跳转标志，发现用apktool解包的dex，里面标志全变了，数字变成每个函数从0开始。然后如果改了关于标志的代码，编译的时候那些就全变了。</p><h3 id="如何将fragment挂载到视图上" tabindex="-1"><a class="header-anchor" href="#如何将fragment挂载到视图上"><span>如何将fragment挂载到视图上</span></a></h3><p>通过Activity.getSupportFragmentManager().beginTransaction().add方法，add传入三个参数：视图id，fragment实例，fragment的tag，将fragment添加到指定的视图中（测试发现只是添加到最后一个，不会清空其他子视图）。由于必须要视图id，不能视图实例，所以要去xml里找了。。</p><p>解压数据包的时候用的是EDStartupActivity，继承自StartupActivity，onCreate的时候设置的布局是start_up.xml。打开xml没想到居然看到了一个隐藏的布局：如下图</p><p><img src="/assets/1-U0ikY-eF.png" alt="image.png"></p><p>好家伙，从来没见过这个。由于设置了visibility=gone，也从来没显示过。而且这个布局是一个有id的线性布局包着的，正好可以拿来用！<br> add传入id。show显示fragment，然后设置视图visibility为visible，再把多余的视图去掉，只留一个fragment的根布局即可。（不确定有无重复添加fragment的情况，为以防这种情况下显示多个fragment，先尝试从碎片管理器中获取tag为之前设置的tag的fragment，如果获取到了就不再add了。）</p><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h2><ul><li>写一个fragment，显示一个按钮，用来选择文件。</li><li>启动加载界面的视图有个没显示过的子视图，正好可以拿来挂载fragment。</li><li>由于安卓限制，安卓11及以上无法使用文件选择器查看Android/data和Android/obb目录下的文件。</li></ul></div></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Last Updated 3/18/2023, 10:07:22 AM<!--]--></span></span></div></footer><!----><!----></div><div class="page-catalog-container"><h5 class="tip">ON THIS PAGE</h5><ul><!--[--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#前言" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="前言"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->前言<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#演示视频" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="演示视频："><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->演示视频：<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#将此功能添加到apk" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="将此功能添加到apk"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->将此功能添加到apk<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#自助修改" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="自助修改"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->自助修改<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#手动修改" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="手动修改"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->手动修改<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#已改好apk" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="已改好apk"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->已改好apk<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#探索过程" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="探索过程"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->探索过程<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#分析ed的dex" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="分析ed的dex"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->分析ed的dex<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#打开系统自带的文件选择器" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="打开系统自带的文件选择器"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->打开系统自带的文件选择器<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#获取文件并让ex读取到这个文件" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="获取文件并让ex读取到这个文件"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->获取文件并让ex读取到这个文件<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#onactivityresult的处理" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="onActivityResult的处理"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->onActivityResult的处理<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#如何将fragment挂载到视图上" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="如何将fragment挂载到视图上"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->如何将fragment挂载到视图上<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/2022/winter/exagearFindObb/#总结" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="总结"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->总结<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--></ul></div></main><!--]--></div></div><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-lSJJfXGm.js" defer></script>
  </body>
</html>
