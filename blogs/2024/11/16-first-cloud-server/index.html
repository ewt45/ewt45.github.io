<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-rc.19">
    <script>
      (function() {
        const userMode = localStorage.getItem('vuepress-reco-color-scheme') || 'auto';
        const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (userMode === 'dark' || (userMode === 'auto' && systemDarkMode)) {
          document.documentElement.classList.toggle('dark', true);
        }
      })();
    </script>
    <title>第一次购买云服务器及基本设置（域名，flask+gunicorn+nginx，ssl证书，vscode远程访问） | 博客</title><meta name="description" content="">
    <link rel="preload" href="/assets/style-BnPP2NeH.css" as="style"><link rel="stylesheet" href="/assets/style-BnPP2NeH.css">
    <link rel="modulepreload" href="/assets/app-lSJJfXGm.js"><link rel="modulepreload" href="/assets/index.html-BlTTay7L.js">
    <link rel="prefetch" href="/assets/timeline.html-BAvVtoBI.js" as="script"><link rel="prefetch" href="/assets/posts.html-BDe9RmJC.js" as="script"><link rel="prefetch" href="/assets/friendship-link.html-5V_0ldeR.js" as="script"><link rel="prefetch" href="/assets/1.html-yy2yFytV.js" as="script"><link rel="prefetch" href="/assets/1.html-nTxjU1Bc.js" as="script"><link rel="prefetch" href="/assets/2.html-DZ-3w1VZ.js" as="script"><link rel="prefetch" href="/assets/3.html-DZ3bEvhb.js" as="script"><link rel="prefetch" href="/assets/1.html-ZRhaUqLX.js" as="script"><link rel="prefetch" href="/assets/1.html-Dw8_-m24.js" as="script"><link rel="prefetch" href="/assets/1.html-D2p--ZRn.js" as="script"><link rel="prefetch" href="/assets/1.html-BKcCMUG3.js" as="script"><link rel="prefetch" href="/assets/1.html-C6pQh-RC.js" as="script"><link rel="prefetch" href="/assets/1.html-CYKCRyI3.js" as="script"><link rel="prefetch" href="/assets/2.html-DJbJUUuj.js" as="script"><link rel="prefetch" href="/assets/1.html-B6B-juSh.js" as="script"><link rel="prefetch" href="/assets/1.html-v9pKxjgF.js" as="script"><link rel="prefetch" href="/assets/1.html-De7IlD7i.js" as="script"><link rel="prefetch" href="/assets/1.html-CHE8FBaR.js" as="script"><link rel="prefetch" href="/assets/1.html-RqMXOz5Q.js" as="script"><link rel="prefetch" href="/assets/1.html-Dof7uOmY.js" as="script"><link rel="prefetch" href="/assets/1.html-C5tNz7tA.js" as="script"><link rel="prefetch" href="/assets/1.html-CNMa2M-d.js" as="script"><link rel="prefetch" href="/assets/1.html-BoJFA7la.js" as="script"><link rel="prefetch" href="/assets/1.html-DK6IPxzw.js" as="script"><link rel="prefetch" href="/assets/1.html-BXhANdLw.js" as="script"><link rel="prefetch" href="/assets/1.html-BmUrsBLW.js" as="script"><link rel="prefetch" href="/assets/1.html-DNaqT86r.js" as="script"><link rel="prefetch" href="/assets/1.html-Dl0GJ-jH.js" as="script"><link rel="prefetch" href="/assets/1.html-yCcpQztl.js" as="script"><link rel="prefetch" href="/assets/1.html-DBv1IOaq.js" as="script"><link rel="prefetch" href="/assets/1.html-C0Zwxfqb.js" as="script"><link rel="prefetch" href="/assets/1.html-iVIhowxE.js" as="script"><link rel="prefetch" href="/assets/1.html-Bcnqkk_9.js" as="script"><link rel="prefetch" href="/assets/1.html-CYVqutMM.js" as="script"><link rel="prefetch" href="/assets/1.html-SDgp3aOs.js" as="script"><link rel="prefetch" href="/assets/1.html-B38hZpmE.js" as="script"><link rel="prefetch" href="/assets/1.html-C9q0qIEw.js" as="script"><link rel="prefetch" href="/assets/1.html-Bg9Js69h.js" as="script"><link rel="prefetch" href="/assets/2.html-eRtQpz5X.js" as="script"><link rel="prefetch" href="/assets/1.html-Dv_I2idE.js" as="script"><link rel="prefetch" href="/assets/1.html-Dn6C90gc.js" as="script"><link rel="prefetch" href="/assets/1.html-y1hVWCcl.js" as="script"><link rel="prefetch" href="/assets/1.html-BSQiaV1J.js" as="script"><link rel="prefetch" href="/assets/1.html-DXi2vSUl.js" as="script"><link rel="prefetch" href="/assets/1.html-Jgq6TbQK.js" as="script"><link rel="prefetch" href="/assets/1.html-CURNMHjC.js" as="script"><link rel="prefetch" href="/assets/1.html-CUfabN0R.js" as="script"><link rel="prefetch" href="/assets/1.html-ChhkJBFb.js" as="script"><link rel="prefetch" href="/assets/1.html-y8Il0XMP.js" as="script"><link rel="prefetch" href="/assets/1.html-CXBcIIjb.js" as="script"><link rel="prefetch" href="/assets/1.html-DEYIk8-q.js" as="script"><link rel="prefetch" href="/assets/1.html-CUB-76jf.js" as="script"><link rel="prefetch" href="/assets/1.html-BR-vtOCm.js" as="script"><link rel="prefetch" href="/assets/1.html-Di6IvUbD.js" as="script"><link rel="prefetch" href="/assets/1.html-iKeLMEA1.js" as="script"><link rel="prefetch" href="/assets/1.html-B23WFga2.js" as="script"><link rel="prefetch" href="/assets/1.html-DBAywDxx.js" as="script"><link rel="prefetch" href="/assets/1.html-C7gBBOTt.js" as="script"><link rel="prefetch" href="/assets/1.html-DtTuhNez.js" as="script"><link rel="prefetch" href="/assets/1.html-CjbxeMTY.js" as="script"><link rel="prefetch" href="/assets/1.html-VedXetm4.js" as="script"><link rel="prefetch" href="/assets/1.html-C7vkUq9U.js" as="script"><link rel="prefetch" href="/assets/1.html-CKoDS6cD.js" as="script"><link rel="prefetch" href="/assets/1.html-D2AjppoH.js" as="script"><link rel="prefetch" href="/assets/1.html-D6uas5Q5.js" as="script"><link rel="prefetch" href="/assets/1.html-DZaxw3Vt.js" as="script"><link rel="prefetch" href="/assets/1.html-Ciw9aOQK.js" as="script"><link rel="prefetch" href="/assets/2.html-Czvu1qhK.js" as="script"><link rel="prefetch" href="/assets/1.html-BL1u0BXg.js" as="script"><link rel="prefetch" href="/assets/1.html-DOrS_H42.js" as="script"><link rel="prefetch" href="/assets/1.html-D_-YFshT.js" as="script"><link rel="prefetch" href="/assets/1.html-C7oQNTeb.js" as="script"><link rel="prefetch" href="/assets/1.html-D6q7O-YE.js" as="script"><link rel="prefetch" href="/assets/1.html-BKtgxFao.js" as="script"><link rel="prefetch" href="/assets/1.html-ChHfA7Ub.js" as="script"><link rel="prefetch" href="/assets/1.html-BYmHK36B.js" as="script"><link rel="prefetch" href="/assets/1.html-kA591iPl.js" as="script"><link rel="prefetch" href="/assets/1.html-B6Z9JHUx.js" as="script"><link rel="prefetch" href="/assets/1.html-DeW5UuLV.js" as="script"><link rel="prefetch" href="/assets/1.html-Ly1Izu-z.js" as="script"><link rel="prefetch" href="/assets/1.html-D0dXHV11.js" as="script"><link rel="prefetch" href="/assets/1.html-CZ6hGlzj.js" as="script"><link rel="prefetch" href="/assets/1.html-CSl7qz7_.js" as="script"><link rel="prefetch" href="/assets/1.html-hoorisB2.js" as="script"><link rel="prefetch" href="/assets/1.html-DfMmJBkA.js" as="script"><link rel="prefetch" href="/assets/1.html-CvjQlPb-.js" as="script"><link rel="prefetch" href="/assets/1.html-mMwmaqNv.js" as="script"><link rel="prefetch" href="/assets/1.html-BbZEnfuL.js" as="script"><link rel="prefetch" href="/assets/1.html-DMy9vnUO.js" as="script"><link rel="prefetch" href="/assets/1.html-CaB-TTNA.js" as="script"><link rel="prefetch" href="/assets/1.html-DTTqmB1M.js" as="script"><link rel="prefetch" href="/assets/1.html-DG0Ri2-3.js" as="script"><link rel="prefetch" href="/assets/1.html-CbdOtFX6.js" as="script"><link rel="prefetch" href="/assets/1.html-BPggE-vd.js" as="script"><link rel="prefetch" href="/assets/1.html-HSH3YtDr.js" as="script"><link rel="prefetch" href="/assets/1.html-CblnYoQH.js" as="script"><link rel="prefetch" href="/assets/1.html-DW3jzJmF.js" as="script"><link rel="prefetch" href="/assets/1.html-EbscoznH.js" as="script"><link rel="prefetch" href="/assets/1.html-BVzHmXLV.js" as="script"><link rel="prefetch" href="/assets/1.html-ks4RjumV.js" as="script"><link rel="prefetch" href="/assets/1.html-BH1KfGMl.js" as="script"><link rel="prefetch" href="/assets/1.html-zPiztlwQ.js" as="script"><link rel="prefetch" href="/assets/1.html-DbQUkwnm.js" as="script"><link rel="prefetch" href="/assets/1.html-lC7lLhGV.js" as="script"><link rel="prefetch" href="/assets/1.html-CLYr7dtL.js" as="script"><link rel="prefetch" href="/assets/1.html-ojawvUMc.js" as="script"><link rel="prefetch" href="/assets/1.html-BZEAgw8b.js" as="script"><link rel="prefetch" href="/assets/1.html-DYCe7dPb.js" as="script"><link rel="prefetch" href="/assets/1.html-DTn0dGU2.js" as="script"><link rel="prefetch" href="/assets/1.html--B2a8o7V.js" as="script"><link rel="prefetch" href="/assets/1.html-7Ua1aPJo.js" as="script"><link rel="prefetch" href="/assets/1.html-Gj4i9rQj.js" as="script"><link rel="prefetch" href="/assets/1.html-BoZMEBVy.js" as="script"><link rel="prefetch" href="/assets/1.html-XU3T-WYT.js" as="script"><link rel="prefetch" href="/assets/1.html-D1V-fulj.js" as="script"><link rel="prefetch" href="/assets/1.html-pymXCC7r.js" as="script"><link rel="prefetch" href="/assets/2.html-Ubr6swgl.js" as="script"><link rel="prefetch" href="/assets/3.html-CjLKwczA.js" as="script"><link rel="prefetch" href="/assets/4.html-CZDmeODS.js" as="script"><link rel="prefetch" href="/assets/5.html-CvM0EXix.js" as="script"><link rel="prefetch" href="/assets/index.html-BBKCb86C.js" as="script"><link rel="prefetch" href="/assets/index.html-Cy-Y6qO0.js" as="script"><link rel="prefetch" href="/assets/index.html--IG5pKEw.js" as="script"><link rel="prefetch" href="/assets/index.html-D_zAtQ3A.js" as="script"><link rel="prefetch" href="/assets/index.html-QY7s6tas.js" as="script"><link rel="prefetch" href="/assets/index.html-DDwaHnCa.js" as="script"><link rel="prefetch" href="/assets/index.html-DgszJxPY.js" as="script"><link rel="prefetch" href="/assets/deprecated.html-CRMXFzvC.js" as="script"><link rel="prefetch" href="/assets/index.html-Rc_VX8bK.js" as="script"><link rel="prefetch" href="/assets/index_EN.html-ByFpT8Si.js" as="script"><link rel="prefetch" href="/assets/index.html-BuF_ye6e.js" as="script"><link rel="prefetch" href="/assets/index.html-DWAaArns.js" as="script"><link rel="prefetch" href="/assets/index.html-CqZrKvZ4.js" as="script"><link rel="prefetch" href="/assets/index.html-BdQrDGCb.js" as="script"><link rel="prefetch" href="/assets/index.html-DfEreS3A.js" as="script"><link rel="prefetch" href="/assets/index.html-xfauZgFa.js" as="script"><link rel="prefetch" href="/assets/index.html-CPq8pEd4.js" as="script"><link rel="prefetch" href="/assets/index.html-QR87e8Ls.js" as="script"><link rel="prefetch" href="/assets/detailed.html-CYf3qOPR.js" as="script"><link rel="prefetch" href="/assets/index.html-CQq5mgbv.js" as="script"><link rel="prefetch" href="/assets/index.html-BMQ4-iAy.js" as="script"><link rel="prefetch" href="/assets/index.html-B679GBm9.js" as="script"><link rel="prefetch" href="/assets/index.html-CCrvZbLJ.js" as="script"><link rel="prefetch" href="/assets/driveD.html-CcD-EJvX.js" as="script"><link rel="prefetch" href="/assets/index.html-BQuueml5.js" as="script"><link rel="prefetch" href="/assets/index.html-gEKDxyu6.js" as="script"><link rel="prefetch" href="/assets/index.html-Bhz11Ob5.js" as="script"><link rel="prefetch" href="/assets/index.html-BkeY5tbW.js" as="script"><link rel="prefetch" href="/assets/index.html-Bvnzpb-9.js" as="script"><link rel="prefetch" href="/assets/index.html-DCAyTCDU.js" as="script"><link rel="prefetch" href="/assets/index.html-DD-LFEVB.js" as="script"><link rel="prefetch" href="/assets/index.html-DkAhnggS.js" as="script"><link rel="prefetch" href="/assets/index.html-DFxQCUU9.js" as="script"><link rel="prefetch" href="/assets/index.html-9VL9SfQK.js" as="script"><link rel="prefetch" href="/assets/index.html-t5GXM772.js" as="script"><link rel="prefetch" href="/assets/index.html-CSlhuypt.js" as="script"><link rel="prefetch" href="/assets/index.html-C5jNpAm8.js" as="script"><link rel="prefetch" href="/assets/index.html-DjJMF_aD.js" as="script"><link rel="prefetch" href="/assets/index.html-Dgv5WEvh.js" as="script"><link rel="prefetch" href="/assets/index.html-DBOL5oAg.js" as="script"><link rel="prefetch" href="/assets/index.html-CyMED2UU.js" as="script"><link rel="prefetch" href="/assets/index.html-Brt8k1u9.js" as="script"><link rel="prefetch" href="/assets/index.html-DTKB9h7D.js" as="script"><link rel="prefetch" href="/assets/index_en.html-BXYBFagB.js" as="script"><link rel="prefetch" href="/assets/index.html-C3TPFGWv.js" as="script"><link rel="prefetch" href="/assets/index.html-BEi31oBx.js" as="script"><link rel="prefetch" href="/assets/index.html-DQMJgohn.js" as="script"><link rel="prefetch" href="/assets/index.html-oa6BlAsi.js" as="script"><link rel="prefetch" href="/assets/index.html-C22QzVzY.js" as="script"><link rel="prefetch" href="/assets/index.html-DoJ7ZtnH.js" as="script"><link rel="prefetch" href="/assets/index.html-BGBq_6tl.js" as="script"><link rel="prefetch" href="/assets/index.html-De0w7Z4M.js" as="script"><link rel="prefetch" href="/assets/index.html-DPCBOMd7.js" as="script"><link rel="prefetch" href="/assets/404.html-BfWx50pL.js" as="script"><link rel="prefetch" href="/assets/Valine.min-Bnm5pcBZ.js" as="script"><link rel="prefetch" href="/assets/giscus-aTimukGI-DWEKOTfS.js" as="script"><link rel="prefetch" href="/assets/PokopeaMain-MDrkiEMa.js" as="script"><link rel="prefetch" href="/assets/example-CYQHARbw.js" as="script"><link rel="prefetch" href="/assets/main-BTkXXdD8.js" as="script"><link rel="prefetch" href="/assets/ActionBili-Czh0m-6-.js" as="script"><link rel="prefetch" href="/assets/ActionDialog-CVwUbXiR.js" as="script"><link rel="prefetch" href="/assets/ActionInfo-B23WMb5r.js" as="script"><link rel="prefetch" href="/assets/ActionSub-Pfdqagrq.js" as="script"><link rel="prefetch" href="/assets/ActionYt-CrnOPkTb.js" as="script"><link rel="prefetch" href="/assets/IconBili-CMtoYxHz.js" as="script"><link rel="prefetch" href="/assets/IconInfo-D1wXkJcd.js" as="script"><link rel="prefetch" href="/assets/IconSub-D5TM9A67.js" as="script"><link rel="prefetch" href="/assets/IconYt-D_vP9lhp.js" as="script"><link rel="prefetch" href="/assets/ToolDarkMode-9w8ghlWD.js" as="script"><link rel="prefetch" href="/assets/ToolFilter-B32drc-T.js" as="script"><link rel="prefetch" href="/assets/ToolInfoLink-DOCFQvn0.js" as="script"><link rel="prefetch" href="/assets/ToolMenus-yA0GO2Nj.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-DfZWbE-_.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container series--no show-catalog"><header class="navbar-container not-open"><div class="navbar-inner"><div class="site-brand nav-item"><!----><a href="/" class="site-name">博客</a></div><div class="nav-item navbar-links-wrapper" style=""><div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div><nav class="navbar-links"><!--[--><div class="navbar-links__item"><a href="/" class="link" aria-label="首页"><!--[--><!--]--><span class="xicon-container left"><!--[--><IconHome class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"></IconHome><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->首页<!--]--></span></span><!--[--><!--]--></a></div><!--]--><!----><span class="xicon-container btn-toggle-dark-mode btn--dark-mode navbar-links__item"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:;"><path d="M15 2h2v3h-2z" fill="currentColor"></path><path d="M27 15h3v2h-3z" fill="currentColor"></path><path d="M15 27h2v3h-2z" fill="currentColor"></path><path d="M2 15h3v2H2z" fill="currentColor"></path><path d="M5.45 6.884l1.414-1.415l2.121 2.122l-1.414 1.414z" fill="currentColor"></path><path d="M23 7.58l2.121-2.12l1.414 1.414l-2.121 2.121z" fill="currentColor"></path><path d="M23.002 24.416l1.415-1.414l2.12 2.122l-1.413 1.414z" fill="currentColor"></path><path d="M5.47 25.13L7.59 23L9 24.42l-2.12 2.12l-1.41-1.41z" fill="currentColor"></path><path d="M16 8a8 8 0 1 0 8 8a8 8 0 0 0-8-8zm0 14a6 6 0 0 1 0-12z" fill="currentColor"></path></svg></span><ul class="social-links navbar-links__item"><!--[--><!--]--></ul></nav><span class="xicon-container btn-toggle-menus"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:;"><circle cx="16" cy="8" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="24" r="2" fill="currentColor"></circle></svg></span></div></div></header><!----><!----><!----><div class="theme-main" style=""><!----><!--[--><main class="page-container"><div class="page-content"><h1 class="page-title">第一次购买云服务器及基本设置（域名，flask+gunicorn+nginx，ssl证书，vscode远程访问）</h1><div class="page-info"><!----><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2024-11-16 19:41<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M11.17 6l3.42 3.41l.58.59H28v16H4V6h7.17m0-2H4a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2H16l-3.41-3.41A2 2 0 0 0 11.17 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><!--[--><a href="/categories/linux/1.html" class="">linux</a><a href="/categories/yunfuwuqi/1.html" class="">云服务器</a><!--]--><!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M10 14a4 4 0 1 1 4-4a4.005 4.005 0 0 1-4 4zm0-6a2 2 0 1 0 1.998 2.004A2.002 2.002 0 0 0 10 8z" fill="currentColor"></path><path d="M16.644 29.415L2.586 15.354A2 2 0 0 1 2 13.941V4a2 2 0 0 1 2-2h9.941a2 2 0 0 1 1.414.586l14.06 14.058a2 2 0 0 1 0 2.828l-9.943 9.943a2 2 0 0 1-2.829 0zM4 4v9.942L18.058 28L28 18.058L13.942 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><!--[--><a href="/tags/yunfuwuqi/1.html" class="">云服务器</a><a href="/tags/tengxunyun/1.html" class="">腾讯云</a><a href="/tags/namesilo/1.html" class="">namesilo</a><a href="/tags/yuming/1.html" class="">域名</a><a href="/tags/flask/1.html" class="">flask</a><a href="/tags/gunicorn/1.html" class="">gunicorn</a><a href="/tags/nginx/1.html" class="">nginx</a><a href="/tags/sslzhengshu/1.html" class="">ssl证书</a><a href="/tags/vscodeyuanchengfangwen/1.html" class="">vscode远程访问</a><!--]--><!--]--></span></span><!----></div><div class="theme-reco-md-content"><div><h2 id="腾讯云" tabindex="-1"><a class="header-anchor" href="#腾讯云"><span>腾讯云</span></a></h2><p>双十一，买了99一年的轻量应用服务器</p><p><img src="/assets/image-B3JRuM0m.png" alt="alt text"></p><p>记录一下入口：<br> 顶端 - 产品 - 云服务器<br> https://cloud.tencent.com/product/cvm <br> 往下滑一点，上云精选的卡片 点击前往<br> 往下滑一点，同价续费 - 选择 轻量2核境外</p><p>实例创建完成后，可以使用OrcaTerm远程终端 <a href="https://cloud.tencent.com/document/product/1207/44642" target="_blank" rel="noopener noreferrer">一键免密登录实例<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 。</p><p>查看轻量服务器实例： https://console.cloud.tencent.com/lighthouse/instance/index</p><p>基本使用： 在网页，服务器列表里，点登录按钮 一键登录。第三方登录要先在三个点里重置密码。 一键登录是用腾讯的orcaterm，跳转到对应的网页终端</p><h2 id="域名" tabindex="-1"><a class="header-anchor" href="#域名"><span>域名</span></a></h2><ul><li><a href="https://www.v2ex.com/t/935577" target="_blank" rel="noopener noreferrer">长期域名在哪里买便宜<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.v2ex.com/t/1066533" target="_blank" rel="noopener noreferrer">你们都在哪儿买的域名<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>买域名要填身份信息，可以用whois查任何域名的身份信息。cf好像会自动隐藏一些</p><blockquote><p>Cloudflare 将删除发送到此域的 WHOIS 记录的所有个人信息。</p></blockquote><p><a href="https://whois.is/blog/cloudflare-whois-privacy/" target="_blank" rel="noopener noreferrer">whois的说明<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>. 好像是说在cf买的域名自动包含隐私服务。</p><blockquote><p>Cloudflare WHOIS privacy is included for free with domain registrations through their registrar. Traditional domain privacy often incurs an additional annual fee.</p></blockquote><p>在cloudflare买, 用paypal付款，出现报错</p><blockquote><p>很抱歉，设置时出现错误。</p></blockquote><p><img src="/assets/image-1-DgHSnZtx.png" alt="alt text"></p><p><a href="https://www.v2ex.com/t/762407" target="_blank" rel="noopener noreferrer">参考<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, 如果f12看到422报错，把手机号的小数点去掉。 post时确实有个小数点,但表单里没有，应该不影响吧 <img src="data:image/png;base64,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" alt="alt text"></p><p>其他还有说网络不要开代理 / 等几天再试 / paypal转美区 / 换信用卡 / 银联借记卡 开通网上银行和境外支付 / paypal</p><ul><li><a href="https://www.v2ex.com/t/914985" target="_blank" rel="noopener noreferrer">CloudFlare 付款的正确姿势是什么?<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.v2ex.com/t/1013585" target="_blank" rel="noopener noreferrer">cloudflare 买域名付款，总是不成功怎么办？<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.zhihu.com/question/350802951" target="_blank" rel="noopener noreferrer">Paypal所谓的支持银联借记卡，实际只能绑定，支付时还是会出问题导致付款失败?<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>尝试改了一堆paypal和银联卡的设置，都没有任何卵用。</p><p>最后换了namesilo.com，直接支付宝啥也不用操心。。。</p><p>域名：dododonut.org</p><p>然后去腾讯云实例 - 域名解析</p><p><img src="/assets/image-4-CWTDj5pS.png" alt="alt text"></p><p>提示未生效。点击跳转到 <a href="https://console.cloud.tencent.com/cns" target="_blank" rel="noopener noreferrer">云解析DNS<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><img src="/assets/image-5-BDfTMp3k.png" alt="alt text"></p><p>发现当前域名的dns服务器是namesilo给的默认的，需要去namesilo里，把这个域名的dns服务器<a href="https://cloud.tencent.com/document/product/302/105673" target="_blank" rel="noopener noreferrer">改成腾讯云提供的<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> （namesilo里这个叫name server....）</p><p>一些名词概念的解释：<a href="https://yoncise.com/2013/07/03/DNS-%E5%92%8C-Nameserver-%E7%9A%84%E5%8C%BA%E5%88%AB/" target="_blank" rel="noopener noreferrer">DNS-和-Nameserver-的区别<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>然后等几个小时或者几天，可以通过 <code>ping 域名</code> 来检查dns服务器是否生效。ip显示为服务器ip就是生效了。</p><p>突然发现还有一种方法是修改dns record，直接填ip就行。两者同时修改时 只有dns服务器生效 https://www.1deng.me/namesilo-dns.html</p><h2 id="flask-web服务器" tabindex="-1"><a class="header-anchor" href="#flask-web服务器"><span>flask web服务器</span></a></h2><blockquote><p>python用自带的模块运行web服务器(http)： 进入网站根目录，运行<code>python -m http.server 端口号</code><br> 需要点进实例，防火墙添加端口号 设置为允许，就能用公网ip+端口访问了。</p></blockquote><p>flask是个py模块，可以用来编写网页 flask提供的web服务器能力有限，开发时可以，但生产环境下部署时用WSGI服务器，如gunicorn。 然后再加一层nginx用于反代，顺便配置ssl证书（https）</p><p><a href="https://flask.palletsprojects.com/en/stable/deploying/" target="_blank" rel="noopener noreferrer">部署<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>：自己托管：wsgi服务器+nginx，或其他托管平台</p><ul><li><a href="https://flask.palletsprojects.com/en/stable/deploying/gunicorn/" target="_blank" rel="noopener noreferrer">Gunicorn<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://flask.palletsprojects.com/en/stable/deploying/nginx/" target="_blank" rel="noopener noreferrer">nginx<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://blog.csdn.net/zybsjn/article/details/142672298" target="_blank" rel="noopener noreferrer">使用 Nginx 和 Gunicorn 部署 Flask 项目详细教程<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://dev.to/chand1012/how-to-host-a-flask-server-with-gunicorn-and-https-942" target="_blank" rel="noopener noreferrer">How to Host a Flask Server With Gunicorn and HTTPS<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>安装</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 首先创建venv</span></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> python3.12-venv</span>
<span class="line">python3 <span class="token parameter variable">-m</span> venv ~/py_venv</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 执行activate，进入venv</span></span>
<span class="line"><span class="token builtin class-name">source</span> ~/py_venv/bin/activate</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 安装flask</span></span>
<span class="line">pip <span class="token function">install</span> flask</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>创建<code>app.py</code></p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask</span>
<span class="line"></span>
<span class="line">app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">hello_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token string">&quot;&lt;p&gt;Hello, World!&lt;/p&gt;&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行flask</p><ul><li><code>flask [--app name] run --port 3498 --host=0.0.0.0</code></li><li>如果文件名叫app.py，可以省略<code>--app 文件名</code></li><li>端口号默认5000,这里改成自己的。</li><li>host默认是127.0.0.1,即只允许本地。改成0.0.0.0允许从外部访问。</li></ul><p>ok了，http的可以访问了</p><h2 id="gunicorn" tabindex="-1"><a class="header-anchor" href="#gunicorn"><span>gunicorn</span></a></h2><p><a href="https://docs.gunicorn.org/" target="_blank" rel="noopener noreferrer">guinicorn文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><a href="https://flask.palletsprojects.com/en/stable/deploying/gunicorn/" target="_blank" rel="noopener noreferrer">flask上的教程<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="安装" tabindex="-1"><a class="header-anchor" href="#安装"><span>安装</span></a></h3><p><code>pip install gunicorn</code> 如果要使用异步workers需要安装 <code>eventlet</code>或<code>gevent</code></p><h3 id="手动运行-http-ip访问" tabindex="-1"><a class="header-anchor" href="#手动运行-http-ip访问"><span>手动运行（http+ip访问）</span></a></h3><p><code>gunicorn -w 3 -b 0.0.0.0:3498 app:app</code></p><ul><li><code>-w</code> 表示使用几个工作线程。推荐个数为cpu核心*2</li><li><code>-b</code> 绑定host和端口</li><li><code>{module_import}:{app_variable}</code> 这里第一个app代表模块名，我这里文件名为<code>app.py</code>所以模块名就是app，第二个app代表Flask实例名，即app.py中有代码<code>app = Flask(__name__)</code></li><li>因为不是把<code>app.py</code>当作模块而非直接运行，所以在main里的app.run的配置不会生效。</li></ul><h3 id="配置开机自动运行-systemd" tabindex="-1"><a class="header-anchor" href="#配置开机自动运行-systemd"><span>配置开机自动运行（systemd）</span></a></h3><p>使用systemd</p><p>创建配置文件 <code>/etc/systemd/system/gunicorn.service</code></p><div class="language-ini line-numbers-mode" data-highlighter="prismjs" data-ext="ini" data-title="ini"><pre><code><span class="line"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Unit</span><span class="token punctuation">]</span></span></span>
<span class="line"><span class="token key attr-name">Description</span><span class="token punctuation">=</span><span class="token value attr-value">Gunicorn Flask Application</span></span>
<span class="line"><span class="token key attr-name">After</span><span class="token punctuation">=</span><span class="token value attr-value">network.target</span></span>
<span class="line"><span class="token key attr-name">After</span><span class="token punctuation">=</span><span class="token value attr-value">systemd-user-sessions.service</span></span>
<span class="line"><span class="token key attr-name">After</span><span class="token punctuation">=</span><span class="token value attr-value">network-online.target</span></span>
<span class="line"></span>
<span class="line"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Service</span><span class="token punctuation">]</span></span></span>
<span class="line"><span class="token key attr-name">User</span><span class="token punctuation">=</span><span class="token value attr-value">lighthouse</span></span>
<span class="line"><span class="token key attr-name">Type</span><span class="token punctuation">=</span><span class="token value attr-value">simple</span></span>
<span class="line"><span class="token key attr-name">ExecStart</span><span class="token punctuation">=</span><span class="token value attr-value">/home/lighthouse/flask/start.sh</span></span>
<span class="line"><span class="token key attr-name">TimeoutSec</span><span class="token punctuation">=</span><span class="token value attr-value">30</span></span>
<span class="line"><span class="token key attr-name">Restart</span><span class="token punctuation">=</span><span class="token value attr-value">on-failure</span></span>
<span class="line"><span class="token key attr-name">RestartSec</span><span class="token punctuation">=</span><span class="token value attr-value">15</span></span>
<span class="line"><span class="token key attr-name">StartLimitInterval</span><span class="token punctuation">=</span><span class="token value attr-value">350</span></span>
<span class="line"><span class="token key attr-name">StartLimitBurst</span><span class="token punctuation">=</span><span class="token value attr-value">10</span></span>
<span class="line"></span>
<span class="line"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Install</span><span class="token punctuation">]</span></span></span>
<span class="line"><span class="token key attr-name">WantedBy</span><span class="token punctuation">=</span><span class="token value attr-value">multi-user.target</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>要执行的<code>/home/lighthouse/flask/start.sh</code> 内容如下。给予执行权限<code>chmod +x</code></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token shebang important">#!/bin/bash</span></span>
<span class="line"><span class="token assign-left variable"><span class="token environment constant">HOME</span></span><span class="token operator">=</span>/home/lighthouse</span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token string">&#39;Starting gunicorn Flask app (systemd).&#39;</span></span>
<span class="line"><span class="token builtin class-name">source</span> <span class="token environment constant">$HOME</span>/py_venv/bin/activate</span>
<span class="line"><span class="token builtin class-name">cd</span> <span class="token environment constant">$HOME</span>/flask</span>
<span class="line">gunicorn <span class="token parameter variable">-w</span> <span class="token number">3</span> <span class="token parameter variable">-b</span> <span class="token number">127.0</span>.0.1:3500 app:app</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>启动应该仅限本地且端口禁止外部访问，因为待会要用nginx反代，外部访问应该都走nginx。</li><li>端口号用3500吧</li></ul><p>设置开机自启 <code>sudo systemctl enable gunicorn</code><br> 其他参数：<code>start</code>：启动，<code>stop</code>：停止，<code>status</code>：查看当前状态。</p><h3 id="手动重启-调试" tabindex="-1"><a class="header-anchor" href="#手动重启-调试"><span>手动重启（调试）</span></a></h3><p><a href="https://cloud.tencent.com/developer/article/1493641" target="_blank" rel="noopener noreferrer">gunicorn重新加载配置和应用<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>修改flask的py代码后，需要重启gunicorn服务器，命令： <code>pstree -ap | grep gunicorn | tr -d &#39;\n&#39; | awk -F, &#39;{print $2}&#39; | awk &#39;{print $1}&#39; | xargs kill -HUP</code></p><ul><li>前两个获取gunicorn的主进程和工作进程。</li><li>然后删去换行（因为awk会按行分别处理）</li><li>然后awk截取逗号后，空格前的内容</li><li>最后执行<code>kill -HUP 主进程id</code> 重启gunicorn</li></ul><h2 id="nginx-http" tabindex="-1"><a class="header-anchor" href="#nginx-http"><span>nginx (http)</span></a></h2><p>nginx连通80/443端口，外部访问时访问到nginx，nginx再转发到gunicorn运行的端口，起到反向代理的作用</p><p>参考</p><ul><li>nginx.org(免费版)</li><li>nginx.com(商业版)</li><li>更多示例参考 <code>/usr/share/doc/nginx-doc/examples/</code></li></ul><p>安装 <code>sudo apt install nginx</code></p><p>删掉<code>/etc/nginx/sites-enabled/default</code> (<code>sites-enabled</code>里的配置是从 <code>site-available</code> 链接过来的，只有<code>enabled</code>中的会生效。)</p><p>新建<code>/etc/nginx/sites-available/flask_gunicorn.conf</code>（然后再建立一个到sites-enabled的软链接）</p><div class="language-conf line-numbers-mode" data-highlighter="prismjs" data-ext="conf" data-title="conf"><pre><code><span class="line">server {</span>
<span class="line">    listen 80;</span>
<span class="line">    listen [::]:80;</span>
<span class="line">    server_name _;</span>
<span class="line">    access_log /var/log/nginx/flask_gunicorn-access.log;</span>
<span class="line">    error_log /var/log/nginx/flask_gunicorn-error.log;</span>
<span class="line"></span>
<span class="line">    location / {</span>
<span class="line">                proxy_set_header X-Real-IP $remote_addr;</span>
<span class="line">                proxy_set_header HOST $http_host;</span>
<span class="line">                proxy_pass http://127.0.0.1:3500;</span>
<span class="line">                proxy_redirect off;</span>
<span class="line">    }</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>这里端口号要和gunicorn设定的对应上</li></ul><p>重启nginx <code>sudo systemctl restart nginx</code></p><p>此时可以通过http访问。但是如果想使用https，需要先申请ssl证书</p><h2 id="https-ssl证书" tabindex="-1"><a class="header-anchor" href="#https-ssl证书"><span>https, ssl证书</span></a></h2><ul><li><a href="https://www.ssllabs.com/ssltest/index.html" target="_blank" rel="noopener noreferrer">ssl检测评估网站<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://console.cloud.tencent.com/ssl" target="_blank" rel="noopener noreferrer">腾讯云的ssl证书<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>免费证书只能一次3个月,只能绑定域名不能绑ip。。。。</p><p>注册好域名了。 <a href="https://github.com/acmesh-official/acme.sh" target="_blank" rel="noopener noreferrer">acme.sh<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 这个似乎可以自动部署和更新（后悔了，麻烦的一批，各种权限不足。下次试试certbot）</p><h3 id="自签名证书" tabindex="-1"><a class="header-anchor" href="#自签名证书"><span>自签名证书</span></a></h3><p>先尝试一下不安全的自签名证书。使用这个，浏览器会提示不安全，最好不要访问。</p><ol><li>使用OpenSSL创建自签名SSL证书 <ol><li>生成私钥和证书签名请求 (CSR)： <code>openssl req -new -newkey rsa:2048 -nodes -keyout key.pem -out csr.pem</code></li><li>生成自签名的SSL证书： <code>openssl x509 -req -days 365 -in csr.pem -signkey key.pem -out cert.pem</code> 这会生成一个有效期为365天的证书 cert.pem，和一个私钥 key.pem。</li></ol></li><li>使用Flask启动HTTPS服务器 <code>app.run(ssl_context=(&#39;cert.pem&#39;, &#39;key.pem&#39;), host=&quot;0.0.0.0&quot;, port=443)</code></li></ol><h3 id="acme-sh" tabindex="-1"><a class="header-anchor" href="#acme-sh"><span>acme.sh</span></a></h3><p><a href="https://github.com/acmesh-official/acme.sh/wiki/%E8%AF%B4%E6%98%8E" target="_blank" rel="noopener noreferrer">中文教程<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h4 id="安装-1" tabindex="-1"><a class="header-anchor" href="#安装-1"><span>安装</span></a></h4><p>安装依赖 <code>apt install ca-certificates</code></p><p>安装 <code>curl https://get.acme.sh | sh -s email=my@example.com</code></p><ul><li>脚本存放在 <code>~/.acme.sh</code>目录下</li><li>自动创建 cronjob, 每天 0:00 点自动更新有需要更新的证书</li></ul><h4 id="生成证书" tabindex="-1"><a class="header-anchor" href="#生成证书"><span>生成证书</span></a></h4><p>一般有两种方式验证: http 和 dns 验证.</p><p>acme.sh脚本默认ca服务器是zerossl，经常出错，卡在 <code>Pending, The CA is processing your order, please just wait.</code> <br><strong>最好改成 letsencrypt</strong><code>acme.sh --set-default-ca --server letsencrypt</code></p><hr><p>http验证： http 方式需要在你的网站根目录下放置一个文件, 来验证你的域名所有权,完成验证. 然后就可以生成证书了. <code>acme.sh --issue -d dododonut.org -d www.dododonut.org --webroot ~/webroot/</code></p><p>不太懂啊，要不要先启动一个http服务器？端口号要用啥啊？？ 算了试试standalone模式</p><hr><p>如果你还没有运行任何 web 服务, 80 端口是空闲的, 那么 acme.sh 还能假装自己是一个webserver, 临时听在80 端口, 完成验证:<br><code>apt install socat # 安装依赖</code><br><code>acme.sh --issue -d dododonut.org -d www.dododonut.org --standalone</code></p><p>提示绑定80端口权限拒绝，请尝试root权限。真用了又提示别用root。<br> 参考<a href="https://github.com/acmesh-official/acme.sh/issues/2622" target="_blank" rel="noopener noreferrer">github上的issue<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, 原因是<a href="https://www.cnblogs.com/chenjunjie12321/p/9226279.html" target="_blank" rel="noopener noreferrer">非root用户默认不能使用1024以下端口<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 允许某程序绑定1024以下端口(不能是软链接所以要用socat1)</span></span>
<span class="line"><span class="token function">sudo</span> setcap <span class="token string">&#39;cap_net_bind_service=+ep&#39;</span> /usr/bin/socat1</span>
<span class="line"><span class="token comment"># 清除能力</span></span>
<span class="line"><span class="token function">sudo</span> setcap <span class="token parameter variable">-r</span> /usr/bin/socat</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>等几个pending之后就好了。</p><p><img src="/assets/image-6-D9aQe6bg.png" alt="alt text"></p><h4 id="安装证书" tabindex="-1"><a class="header-anchor" href="#安装证书"><span>安装证书</span></a></h4><p>nginx示例</p><p>将证书导出到指定路径，并配置证书更新后的执行命令</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">acme.sh --install-cert <span class="token parameter variable">-d</span> dododonut.org <span class="token parameter variable">-d</span> www.dododonut.org <span class="token punctuation">\</span></span>
<span class="line">--key-file       /home/lighthouse/flask/ssl/dododonut.org.key  <span class="token punctuation">\</span></span>
<span class="line">--fullchain-file /home/lighthouse/flask/ssl/dododonut.org.crt <span class="token punctuation">\</span></span>
<span class="line"><span class="token parameter variable">--reloadcmd</span>      <span class="token string">&quot;sudo service nginx force-reload&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>key</code>是私钥，<code>fullchain</code>是证书（完整证书链）</li><li><code>reloadcmd</code> 指定证书更新后的执行命令</li><li>因为普通用户所以没法把证书安装到<code>/etc/ssl</code>下。好在reloadcmd可以用sudo</li></ul><p>生成DH参数文件 提高安全性 <code>openssl dhparam -out /home/lighthouse/flask/ssl/dhparam.pem 2048</code></p><p>修改nginx配置文件<code>/etc/nginx/sites-available/flask_gunicorn.conf</code></p><div class="language-nginx line-numbers-mode" data-highlighter="prismjs" data-ext="nginx" data-title="nginx"><pre><code><span class="line"><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">80</span></span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">listen</span> [::]:80</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">server_name</span> dododonut.org www.dododonut.org</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token directive"><span class="token keyword">return</span> <span class="token number">301</span> https://<span class="token variable">$server_name</span><span class="token variable">$request_uri</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">443</span> ssl</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">listen</span> [::]:443 ssl</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">server_name</span> dododonut.org www.dododonut.org</span><span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">    <span class="token comment"># 指定 SSL 证书和私钥文件</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">ssl_certificate</span> /home/lighthouse/flask/ssl/dododonut.org.crt</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">ssl_certificate_key</span> /home/lighthouse/flask/ssl/dododonut.org.key</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token directive"><span class="token keyword">ssl_dhparam</span> /home/lighthouse/flask/ssl/dhparam.pem</span><span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">    <span class="token comment"># HTTP 头配置（提升安全性）</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">add_header</span> Strict-Transport-Security <span class="token string">&quot;max-age=31536000; includeSubDomains; preload&quot;</span> always</span><span class="token punctuation">;</span>  <span class="token comment"># HSTS（强制 HTTPS）</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">add_header</span> X-Frame-Options <span class="token string">&quot;DENY&quot;</span> always</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">add_header</span> X-XSS-Protection <span class="token string">&quot;1; mode=block&quot;</span> always</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">add_header</span> X-Content-Type-Options <span class="token string">&quot;nosniff&quot;</span> always</span><span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token directive"><span class="token keyword">proxy_set_header</span> X-Real-IP <span class="token variable">$remote_addr</span></span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token directive"><span class="token keyword">proxy_set_header</span> HOST <span class="token variable">$http_host</span></span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token directive"><span class="token keyword">proxy_pass</span> http://127.0.0.1:3500</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token directive"><span class="token keyword">proxy_redirect</span> <span class="token boolean">off</span></span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>重定向http到https。301永久重定向 302临时重定向</li><li>添加ssl证书和DH参数的路径</li><li><a href="https://blog.csdn.net/liulangdewoniu/article/details/116459468" target="_blank" rel="noopener noreferrer">http响应头安全策略（nginx版）<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>重启nginx<br><code>sudo service nginx force-reload</code><br> 或<br><code>sudo systemctl restart nginx</code> （restart和reload不确定用哪个）</p><p>重启失败，报错</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">Job for nginx.service failed because the control process exited with error code.</span>
<span class="line">See &quot;systemctl status nginx.service&quot; and &quot;journalctl -xeu nginx.service&quot; for details.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>然而通过systemd启动的服务，根据提示却找不到报错日志。</p><p>手动启动来排查错误</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">sudo nginx -t # 检查配置文件</span>
<span class="line">sudo nginx -s reload # 重新加载配置文件</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>注意这里配置文件指的是nginx.conf而非 某网站的配置。<br> 不过reload的时候也读取了我的网站配置，报错提示密钥路径不存在。改正后再次启动，没问题了。</p><h2 id="vscode远程访问文件夹" tabindex="-1"><a class="header-anchor" href="#vscode远程访问文件夹"><span>vscode远程访问文件夹</span></a></h2><ul><li>安装插件 <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-ssh" target="_blank" rel="noopener noreferrer">Remote - SSH<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>参考<a href="https://aka.ms/vscode-remote/ssh/tutorial" target="_blank" rel="noopener noreferrer">插件教程<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>服务器系统: ubuntu24</p><p>本机：ubuntu22</p><h3 id="安装依赖" tabindex="-1"><a class="header-anchor" href="#安装依赖"><span>安装依赖</span></a></h3><p>服务器：<code>sudo apt install openssh-server</code></p><p>本机：<code>sudo apt install openssh-client</code></p><h3 id="生成密钥-本机" tabindex="-1"><a class="header-anchor" href="#生成密钥-本机"><span>生成密钥（本机</span></a></h3><p><code>ssh-keygen -t ed25519</code></p><p>没填密码。公钥文件默认保存在 <code>用户目录/.ssh</code></p><h3 id="公钥上传到服务器" tabindex="-1"><a class="header-anchor" href="#公钥上传到服务器"><span>公钥上传到服务器</span></a></h3><p>进入<a href="https://console.cloud.tencent.com/lighthouse/sshkey/index" target="_blank" rel="noopener noreferrer">轻量云 SSH密钥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> - 创建密钥 - 使用已有公钥 填写刚才生成的pub文件内容，然后绑定实例。<br> 这种方式会绑定到ubuntu用户，ssh也只能登录这个用户。</p><p>手动绑定到lighthouse用户：<br> 创建<code>/home/lighthouse/.ssh/authorized_keys</code> 并填入公钥内容。</p><h3 id="vscode连接" tabindex="-1"><a class="header-anchor" href="#vscode连接"><span>vscode连接</span></a></h3><p>本机打开vscode，点击左下角的两个箭头 - 连接到主机 输入 <code>lighthouse@服务器公网ip</code> <br> 连接后，左下角会显示已连接到的ip，点击可以断开连接。 终端、打开文件夹 会访问服务器上的。</p><p>vscode左侧有远程资源管理器，可以保存配置。</p><p><img src="/assets/image-7-Cueqi7vT.png" alt="alt text"></p><p>选择一个配置文件后，还是输入用户名和ip<br> 鼠标点击箭头即可连接，列表中还会显示最近打开过的文件夹</p><p><img src="/assets/image-8-BxRBtIlP.png" alt="alt text"></p></div></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Last Updated 11/17/2024, 5:33:08 AM<!--]--></span></span></div></footer><!----><!----></div><div class="page-catalog-container"><h5 class="tip">ON THIS PAGE</h5><ul><!--[--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#腾讯云" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="腾讯云"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->腾讯云<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#域名" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="域名"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->域名<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#flask-web服务器" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="flask web服务器"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->flask web服务器<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#gunicorn" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="gunicorn"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->gunicorn<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#安装" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="安装"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->安装<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#手动运行-http-ip访问" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="手动运行（http+ip访问）"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->手动运行（http+ip访问）<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#配置开机自动运行-systemd" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="配置开机自动运行（systemd）"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->配置开机自动运行（systemd）<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#手动重启-调试" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="手动重启（调试）"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->手动重启（调试）<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#nginx-http" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="nginx (http)"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->nginx (http)<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#https-ssl证书" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="https, ssl证书"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->https, ssl证书<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#自签名证书" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="自签名证书"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->自签名证书<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#acme-sh" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="acme.sh"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->acme.sh<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#vscode远程访问文件夹" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="vscode远程访问文件夹"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->vscode远程访问文件夹<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#安装依赖" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="安装依赖"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->安装依赖<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#生成密钥-本机" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="生成密钥（本机"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->生成密钥（本机<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#公钥上传到服务器" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="公钥上传到服务器"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->公钥上传到服务器<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/2024/11/16-first-cloud-server/#vscode连接" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="vscode连接"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->vscode连接<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--]--></ul></div></main><!--]--></div></div><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-lSJJfXGm.js" defer></script>
  </body>
</html>
